var w=Object.defineProperty;var C=(a,e,t)=>e in a?w(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var d=(a,e,t)=>C(a,typeof e!="symbol"?e+"":e,t);import{r as y,g as v,a as O,e as n,y as p,i as L,b as m,c as $,d as j,f as B,h as T,j as E,k as N,l as A,m as z,u as D}from"./useDesign-jPeGL5oW.js";import{T as I,s as F}from"./index-DAtyrCpe.js";import{i as G}from"./install-C5chah0n.js";import{i as P}from"./installMarkPoint-CAtSYxcF.js";import{d as J,c as M,r as R,h as V,b as H,e as U,f as W,i as k,j as q,n as x,u as K,_ as Q}from"./index-PWaRPkkw.js";import{w as X}from"./withInstall-Df4KX8Pz.js";class g{constructor({options:e,seriesItem:t}){d(this,"normal");var l;this.normal={label:{show:!e.hiddenLabel,position:((l=t==null?void 0:t.label)==null?void 0:l.position)||(e==null?void 0:e.labelPosition)||"top",textStyle:{color:n.$fontColor||n.fontColor,fontSize:14},formatter:function(s){if(e.dataset){var r=s.data;return r[s.seriesName]===null||r[s.seriesName]<1?"":r[s.seriesName]}else return e.labelFormatter?e.labelFormatter(s):s.value}}}}}class Y{constructor({options:e,data:t}){d(this,"option");this.option={toolbox:v(e),title:{text:e.title||null},tooltip:O(e),legend:{top:10,right:75,padding:[0,0,0,0],itemGap:30,itemHeight:3,textStyle:{color:n.$fontColor||n.fontColor,fontSize:12},show:!0},grid:{bottom:30,top:40,left:25,right:50,containLabel:!0},dataset:e.dataset?{dimensions:Object.keys(t[0]),source:t}:null,xAxis:{data:(()=>{if(!e.dataset)return t&&t.xAxis})(),splitLine:{show:e.isCross,lineStyle:{type:"dashed",color:"#E8E8E8"}},type:"category",axisLabel:{width:120,hideOverlap:!1,interval:0,overflow:"break",rotate:"10",align:"center",verticalAlign:"top"},axisLine:{lineStyle:{color:"#CCCCCC"}}},yAxis:e.yAxis||p,series:(()=>{if(e.dataset){let l=0;t&&t[0]&&(l=L(t[0])?Object.keys(t[0]).length-1:t[0].length-1);const s=[];for(let r=0;r<l;r++)s.push({type:"bar",markLine:m(e,t),barGap:"20%",barCategoryGap:"100%",stack:e.stackIndex&&e.stackIndex.indexOf(r)>-1,itemStyle:new g({options:e})});return s}else{const l=[];return t?(t.series&&t.series.length>0&&t.series.forEach((s,r)=>{if(s.type=s.type||"bar",s.barMaxWidth=38,e.emphasisDsiabled||(s.emphasis={focus:"series"}),s.markLine=m(e,t),s.itemStyle=new g({options:e,seriesItem:s}),e.stackIndex&&(s.stack=e.stackIndex.indexOf(r)>-1),e.stackLabel){s.stack=e.stackLabel[r];const c=t.series.filter(i=>i.stack===s.stack);if(c.length>1&&l.indexOf(c[0].stack)===-1){const i=JSON.parse(JSON.stringify(c[0]));l.push(i.stack);const f=[];i.data.forEach((o,b)=>{let h=0;c.forEach(S=>{h=S.data[b]+h}),f.push(h)}),i.data=f;const u={show:!0,position:"top",offset:e.stackTotalLabelPosion||[0,0],textStyle:{color:n.$fontColor||n.fontColor,fontSize:16},formatter:function(o){return`{total|${f[o.dataIndex].toFixed(1)}}
 ${o.value}`},rich:{total:{color:n.$standardColor||n.standardColor,fontSize:16}}};for(let o=t.series.length-1;o>=0;o--)if(t.series[o].stack===i.stack){t.series[o].itemStyle.normal.label=u;break}}}}),t.series||[]):[]}})()}}}function Z(a){const{data:e}=a,t=new Y({options:a.params,data:e}).option,l=y({},t,a.options);return a.options.series&&(l.series=y([],t.series,a.options.series)),a.params.dataset&&e.length>1&&(l.dataset.source=e.reverse(),l.dataset.dimensions=Object.keys(e[0])),l}const _=["id"],ee=J({__name:"index",props:{id:{type:String,default:null},height:{type:String,default:"500px"},width:{type:String,default:"100%"},showCheckbox:{type:Boolean,default:!0},showTips:{type:Boolean,default:!0},className:{type:String,default:null},options:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},params:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1}},emits:$,setup(a,{emit:e}){j([G,T,E,N,A,z,P]);const t=e,l=a,s=M(()=>Z(l)),r=R(null),{chart:c}=B(r,s.value,l.data,t,l.loading);function i(o){F(s.value,o),c.value.setOption(s.value)}V(()=>{c.value.setOption(s.value)});const{getPrefixCls:f}=D(),u=f("bar");return(o,b)=>(H(),U("div",{class:x([`${K(u)}`])},[W(I,{showTips:a.showTips,showCheckbox:a.showCheckbox,onSetShowLabel:i,data:l==null?void 0:l.data,style:k({width:a.width})},null,8,["showTips","showCheckbox","data","style"]),q("div",{id:a.id,class:x(a.className),style:k({height:a.height,width:a.width}),ref_key:"barChartRef",ref:r},null,14,_)],2))}}),te=Q(ee,[["__scopeId","data-v-604b6120"]]),ce=X(te);export{ce as v};
