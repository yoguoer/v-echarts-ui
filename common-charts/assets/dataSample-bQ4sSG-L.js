import{aW as D,O as N,bj as C,bk as b,I as x,ac as F,bl as E,bm as P,bn as k,ab as G,am as M,bo as B,bp as L,o as j,bq as T,br as I,bf as _,z as w,aF as y,aw as z,aK as H}from"./useDesign-jPeGL5oW.js";var U=function(){function a(e){this.coordSysDims=[],this.axisMap=C(),this.categoryAxisMap=C(),this.coordSysName=e}return a}();function W(a){var e=a.get("coordinateSystem"),t=new U(e),n=q[e];if(n)return n(a,t,t.axisMap,t.categoryAxisMap),t}var q={cartesian2d:function(a,e,t,n){var r=a.getReferringComponents("xAxis",D).models[0],i=a.getReferringComponents("yAxis",D).models[0];e.coordSysDims=["x","y"],t.set("x",r),t.set("y",i),h(r)&&(n.set("x",r),e.firstCategoryDimIndex=0),h(i)&&(n.set("y",i),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(a,e,t,n){var r=a.getReferringComponents("singleAxis",D).models[0];e.coordSysDims=["single"],t.set("single",r),h(r)&&(n.set("single",r),e.firstCategoryDimIndex=0)},polar:function(a,e,t,n){var r=a.getReferringComponents("polar",D).models[0],i=r.findAxisModel("radiusAxis"),s=r.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",i),t.set("angle",s),h(i)&&(n.set("radius",i),e.firstCategoryDimIndex=0),h(s)&&(n.set("angle",s),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(a,e,t,n){e.coordSysDims=["lng","lat"]},parallel:function(a,e,t,n){var r=a.ecModel,i=r.getComponent("parallel",a.get("parallelIndex")),s=e.coordSysDims=i.dimensions.slice();N(i.parallelAxisIndex,function(l,o){var f=r.getComponent("parallelAxis",l),u=s[o];t.set(u,f),h(f)&&(n.set(u,f),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=o))})}};function h(a){return a.get("type")==="category"}function K(a,e){var t=a.get("coordinateSystem"),n=L.get(t),r;return e&&e.coordSysDims&&(r=j(e.coordSysDims,function(i){var s={name:i},l=e.axisMap.get(i);if(l){var o=l.get("type");s.type=T(o)}return s})),r||(r=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),r}function V(a,e,t){var n,r;return t&&N(a,function(i,s){var l=i.coordDim,o=t.categoryAxisMap.get(l);o&&(n==null&&(n=s),i.ordinalMeta=o.getOrdinalMeta(),e&&(i.createInvertedIndices=!0)),i.otherDims.itemName!=null&&(r=!0)}),!r&&n!=null&&(a[n].otherDims.itemName=0),n}function ae(a,e,t){t=t||{};var n=e.getSourceManager(),r,i=!1;r=n.getSource(),i=r.sourceFormat===b;var s=W(e),l=K(e,s),o=t.useEncodeDefaulter,f=x(o)?o:o?F(E,l,e):null,u={coordDimensions:l,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:f,canOmitUnusedDimensions:!i},c=P(r,u),d=V(c.dimensions,t.createInvertedIndices,s),g=i?null:n.getSharedDataStore(c),v=k(e,{schema:c,store:g}),m=new G(c,e);m.setCalculationInfo(v);var p=d!=null&&J(r)?function(R,O,S,A){return A===d?S:this.defaultDimValueGetter(R,O,S,A)}:null;return m.hasItemOption=!1,m.initData(i?r:g,null,p),m}function J(a){if(a.sourceFormat===b){var e=Q(a.data||[]);return!M(B(e))}}function Q(a){for(var e=0;e<a.length&&a[e]==null;)e++;return a[e]}function te(a,e){var t=a.mapDimensionsAll("defaultedLabel"),n=t.length;if(n===1){var r=I(a,e,t[0]);return r!=null?r+"":null}else if(n){for(var i=[],s=0;s<t.length;s++)i.push(I(a,e,t[s]));return i.join(" ")}}function ne(a,e){var t=a.mapDimensionsAll("defaultedLabel");if(!M(e))return e+"";for(var n=[],r=0;r<t.length;r++){var i=a.getDimensionIndex(t[r]);i>=0&&n.push(e[i])}return n.join(" ")}function X(a,e,t,n,r){var i=a.getArea(),s=i.x,l=i.y,o=i.width,f=i.height,u=t.get(["lineStyle","width"])||2;s-=u/2,l-=u/2,o+=u,f+=u,o=Math.ceil(o),s!==Math.floor(s)&&(s=Math.floor(s),o++);var c=new _({shape:{x:s,y:l,width:o,height:f}});if(e){var d=a.getBaseAxis(),g=d.isHorizontal(),v=d.inverse;g?(v&&(c.shape.x+=o),c.shape.width=0):(v||(c.shape.y+=f),c.shape.height=0);var m=x(r)?function(p){r(p,c)}:null;w(c,{shape:{width:o,height:f,x:s,y:l}},t,null,n,m)}return c}function Y(a,e,t){var n=a.getArea(),r=y(n.r0,1),i=y(n.r,1),s=new z({shape:{cx:y(a.cx,1),cy:y(a.cy,1),r0:r,r:i,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(e){var l=a.getBaseAxis().dim==="angle";l?s.shape.endAngle=n.startAngle:s.shape.r=r,w(s,{shape:{endAngle:n.endAngle,r:i}},t)}return s}function re(a,e,t,n,r){if(a){if(a.type==="polar")return Y(a,e,t);if(a.type==="cartesian2d")return X(a,e,t,n,r)}else return null;return null}var Z={average:function(a){for(var e=0,t=0,n=0;n<a.length;n++)isNaN(a[n])||(e+=a[n],t++);return t===0?NaN:e/t},sum:function(a){for(var e=0,t=0;t<a.length;t++)e+=a[t]||0;return e},max:function(a){for(var e=-1/0,t=0;t<a.length;t++)a[t]>e&&(e=a[t]);return isFinite(e)?e:NaN},min:function(a){for(var e=1/0,t=0;t<a.length;t++)a[t]<e&&(e=a[t]);return isFinite(e)?e:NaN},minmax:function(a){for(var e=-1/0,t=-1/0,n=0;n<a.length;n++){var r=a[n],i=Math.abs(r);i>e&&(e=i,t=r)}return isFinite(t)?t:NaN},nearest:function(a){return a[0]}},$=function(a){return Math.round(a.length/2)};function ie(a){return{seriesType:a,reset:function(e,t,n){var r=e.getData(),i=e.get("sampling"),s=e.coordinateSystem,l=r.count();if(l>10&&s.type==="cartesian2d"&&i){var o=s.getBaseAxis(),f=s.getOtherAxis(o),u=o.getExtent(),c=n.getDevicePixelRatio(),d=Math.abs(u[1]-u[0])*(c||1),g=Math.round(l/d);if(isFinite(g)&&g>1){i==="lttb"&&e.setData(r.lttbDownSample(r.mapDimension(f.dim),1/g));var v=void 0;H(i)?v=Z[i]:x(i)&&(v=i),v&&e.setData(r.downSample(r.mapDimension(f.dim),1/g,v,$))}}}}}export{te as a,X as b,ae as c,Y as d,ie as e,re as f,ne as g};
